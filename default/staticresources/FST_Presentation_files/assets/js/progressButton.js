!function(t){"use strict";function e(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}function n(t,n){this.button=t,this.options=e({},this.options),e(this.options,n),this._init()}Modernizr.addTest("csstransformspreserve3d",function(){var e,n=Modernizr.prefixed("transformStyle"),s="preserve-3d";return!!n&&(n=n.replace(/([A-Z])/g,function(t,e){return"-"+e.toLowerCase()}).replace(/^ms-/,"-ms-"),Modernizr.testStyles("#modernizr{"+n+":"+s+";}",function(s,i){e=t.getComputedStyle?getComputedStyle(s,null).getPropertyValue(n):""}),e===s)});var s={transitions:Modernizr.csstransitions,transforms3d:Modernizr.csstransforms3d&&Modernizr.csstransformspreserve3d},i={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd",transition:"transitionend"},r=i[Modernizr.prefixed("transition")];n.prototype.options={statusTime:1500},n.prototype._init=function(){this._validate(),this._create(),this._initEvents()},n.prototype._validate=function(){null===this.button.getAttribute("data-style")&&this.button.setAttribute("data-style","fill"),null===this.button.getAttribute("data-vertical")&&null===this.button.getAttribute("data-horizontal")&&this.button.setAttribute("data-horizontal",""),s.transforms3d||null===this.button.getAttribute("data-perspective")||(this.button.removeAttribute("data-perspective"),this.button.setAttribute("data-style","fill"),this.button.removeAttribute("data-vertical"),this.button.setAttribute("data-horizontal",""))},n.prototype._create=function(){this.onLoadText=this.button.getAttribute("data-text"),this.currentText=this.button.innerHTML;var t=document.createElement("span");t.className="content",t.innerHTML=this.button.innerHTML;var e=document.createElement("span");e.className="progress";var n=document.createElement("span");if(n.className="progress-inner",e.appendChild(n),this.button.innerHTML="",null!==this.button.getAttribute("data-perspective")){var s=document.createElement("span");s.className="progress-wrap",s.appendChild(t),s.appendChild(e),this.button.appendChild(s)}else this.button.appendChild(t),this.button.appendChild(e);this.progress=n,null!==this.button.getAttribute("data-horizontal")?this.progressProp="width":null!==this.button.getAttribute("data-vertical")&&(this.progressProp="height"),this._enable()},n.prototype._setProgress=function(t){this.progress.style[this.progressProp]=100*t+"%"},n.prototype._initEvents=function(){var t=this;this.button.addEventListener("click",function(){t.button.setAttribute("disabled",""),classie.remove(t.progress,"notransition"),classie.add(this,"state-loading"),t.button.getElementsByClassName("content")[0].innerHTML=t.onLoadText,setTimeout(function(){if("function"==typeof t.options.callback)t.options.callback(t);else{t._setProgress(1);var e=function(n){s.transitions&&n.propertyName!==t.progressProp||(this.removeEventListener(r,e),t._stop())};s.transitions?t.progress.addEventListener(r,e):e.call()}},"fill"===t.button.getAttribute("data-style")||"top-line"===t.button.getAttribute("data-style")||"lateral-lines"===t.button.getAttribute("data-style")?0:200)})},n.prototype._stop=function(t){var e=this;setTimeout(function(){e.progress.style.opacity=0;var n=function(t){s.transitions&&"opacity"!==t.propertyName||(this.removeEventListener(r,n),classie.add(e.progress,"notransition"),e.progress.style[e.progressProp]="0%",e.progress.style.opacity=1)};if(s.transitions?e.progress.addEventListener(r,n):n.call(),"number"==typeof t){var i=t>=0?"state-success":"state-error";classie.add(e.button,i),setTimeout(function(){classie.remove(e.button,i),e._enable()},e.options.statusTime)}else e._enable();classie.remove(e.button,"state-loading"),e.button.getElementsByClassName("content")[0].innerHTML=e.currentText},100)},n.prototype._enable=function(){this.button.removeAttribute("disabled")},t.ProgressButton=n}(window);