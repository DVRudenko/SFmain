$(document).ready(function(){function e(e){this.comments=$(e).find(".comment-block"),this.openPopupBtn=$(e).find(".button-chat"),this.closePopupBtn=this.comments.find(".button-popup-close"),this.openPopupBtn.on("click",this.openPopup.bind(this)),this.closePopupBtn.on("click",this.closePopup.bind(this))}function t(e){this.enableScroll=!0,this.nav=$(e),this.openBlock=this.nav.find(".active-block"),this.links=this.nav.find(".sub-menu-item"),this.activeLink=this.nav.find(".active-item"),this.links.on("click",this.toggleSlide.bind(this)),this.openBlock.on("click",this.openPopup.bind(this)),$(window).on("scroll",this.scrollContent.bind(this))}function i(e){this.popups=$(e),this.openPupupBtn=$(".button-menu"),this.openPupupFormBtn=$(".button-user"),this.openPupupBtn.on("click",this.openPopup.bind(this)),this.openPupupFormBtn.on("click",this.openPopup.bind(this)),$(window).on("click",this.closePopup.bind(this))}function n(e){$.validator.messages.required="Это поле обязательно для заполнения";var t=this;this.form=$(e),this.form.validate({errorClass:"error",validClass:"valid",rules:{field:{required:!0}},messages:{region:{required:"Введите свой регион"},postav:{required:"Введите хоть что-то"}},submitHandler:function(e){return $.ajax({type:"POST",url:"submit.php",data:$(e).serialize(),success:function(){setTimeout(function(){t.formPopup.removeClass("open"),b.closePopups(),t.form.removeClass("waiting"),t.form[0].reset(),t.submitBtn.attr("disabled",!0),t.openPopupBtn.attr("disabled",!0),$(".success-submit").addClass("open"),setTimeout(function(){$(".success-submit").removeClass("open")},2e3),console.log("success")},5e3)}}),!1}}),this.formPopup=this.form.find(".form-popup"),this.submitBtn=this.form.find(".button-submit").attr("disabled",!0),this.openPopupBtn=this.form.find(".button-success").attr("disabled",!0),this.closePopupBtn=this.form.find(".button-popup-close"),this.openPopupBtn.on("click",this.openPopup.bind(this)),this.closePopupBtn.on("click",this.closePopup.bind(this)),this.form.on("change",this.checkValid.bind(this)),this.submitBtn.on("click",this.submitForm.bind(this))}function o(e){this.popup=$(e),this.openPopupBtn=$(".button-logout"),this.closePopupBtn=this.popup.find(".button-popup-close"),this.openPopupBtn.on("click",this.openPopup.bind(this)),this.closePopupBtn.on("click",this.closePopup.bind(this))}function s(){r(),p(),a(),d()}function a(){var e=h.realIndex;$(".swiper-container-navigation .swiper-slide").removeClass("active-nav"),m.slideTo(e,0,!1),$(m.slides[e]).addClass("active-nav");var t=$(m.slides[e]).data("slide"),i=$(".menu .sub-menu li[data-hash="+t+"]");g.toggleActiveLink(i);var n=$(".button-return"),o=$(h.slides[e]).data("return");n.data("return",o)}function r(){var e=h.activeIndex;$(h.slides[e]).hasClass("swiper-nested-slide")?h.mousewheel.disable():h.mousewheel.enable()}function p(){var e=$(".nested-button-prev"),t=$(".nested-button-next"),i=Math.floor(100*this.progress);if($(window).width()>=1024){var n=h.activeIndex,o=$(h.slides[n]),s=o.find(".swiper-container-nested").data("el"),a=f[s];0===i||100===i||a&&a.isBeginning&&a.isEnd||!o.hasClass("swiper-nested-slide")?(w&&h.mousewheel.enable(),w=!0):(h.mousewheel.disable(),w=!1)}$(f).each(function(){var i=Math.floor(100*this.progress);i<=10?($(this.$el).removeClass("scroll-begin"),e.hide()):($(this.$el).addClass("scroll-begin"),e.show()),i>=90?($(this.$el).removeClass("scroll-end"),t.hide()):($(this.$el).addClass("scroll-end"),t.show())})}function l(){var e=new Swiper(".swiper-container-parent",{direction:"horizontal",keyboard:!0,init:!1,mousewheel:!0,navigation:{nextEl:".button-next",prevEl:".button-prev"},spaceBetween:10,hashNavigation:{watchState:!0,replaceState:!0}});return e.on("init",s),e.on("slideChange",function(){a(),p(),d()}),e}function c(){var e=new Swiper(".swiper-container-scroll",{direction:"vertical",slidesPerView:"auto",freeMode:!0,nested:!0,resizeEvent:"auto",scrollbar:{el:".swiper-scrollbar"},mousewheel:!0});return $(e).each(function(){this.on("progress",p)}),e}function u(){if($(window).width()<=1024){h&&v&&(h.destroy(),$(v).each(function(){this.destroy()}),h=null,v=null),$(".table-container").overlayScrollbars({});var e=$(".swiper-container-parent > .swiper-wrapper > .swiper-slide").eq(0).data("hash"),t=$(".menu .sub-menu li[data-hash="+e+"]");g.toggleActiveLink(t),p()}else h||v||(h=l(),h.init(),h.update(),v=c(),$(v).each(function(){this.update()}))}function d(){var e=h.activeIndex;$(h.slides[e]).data("return")?$(".button-return").show():$(".button-return").hide()}var h,v,f,m,w=!1;e.prototype.openPopup=function(){this.comments.addClass("open"),this.comments.find("textarea").focus()},e.prototype.closePopup=function(){this.comments.removeClass("open")},t.prototype.scrollContent=function(){if($(window).width()<=1024){var e=this,t=$(window).scrollTop();$(".swiper-container-parent > .swiper-wrapper > .swiper-slide").each(function(){var i=$(this);if(i.position().top<=t&&i.position().top+i.height()>t+40){var n=e.links.filter('[data-hash="'+i.data("hash")+'"]');e.enableScroll&&e.toggleActiveLink(n)}})}},t.prototype.toggleSlide=function(e){e.preventDefault();var t=this,i=$(e.target).closest(".sub-menu-item");if(i.length){var n,o=i.data("hash");$(window).width()<=1024?(n=$(".swiper-container-parent .swiper-slide[data-hash="+o+"]"),t.enableScroll=!1,$("html, body").animate({scrollTop:n.offset().top-70},500,function(){t.enableScroll=!0}),this.toggleActiveLink(i)):(n=$(".swiper-container-parent .swiper-slide[data-hash="+o+"]").index(),$(".swiper-container-navigation .swiper-slide").removeClass("active-nav"),m.slideTo(n,0,!1),h.slideTo(n,500,!1),this.toggleActiveLink(i))}},t.prototype.toggleActiveLink=function(e){e.length&&(this.links.removeClass("active"),e.addClass("active"),this.activeLink.find(".active-item-text").text(e.eq(0).text()))},t.prototype.openPopup=function(e){e.preventDefault(),$(e.target).closest(".active-block").toggleClass("open")},i.prototype.openPopup=function(e){e.preventDefault();var t=$(e.target).closest(".navigation").data("type"),i=this.popups.filter('[data-type="'+t+'"]');0!==i.length&&(this.popups.removeClass("open"),i.addClass("open"))},i.prototype.closePopup=function(e){$(e.target).closest(".slider-nav, .button-menu, .button-user").length&&!$(e.target).closest(".button-close").length||this.popups.removeClass("open")},i.prototype.closePopups=function(){this.popups.removeClass("open")},n.prototype.closePopup=function(){this.form.removeClass("waiting"),this.formPopup.removeClass("open")},n.prototype.openPopup=function(){this.form.addClass("waiting"),this.formPopup.addClass("open")},n.prototype.checkValid=function(){this.form.valid()?(this.submitBtn.removeAttr("disabled"),this.openPopupBtn.removeAttr("disabled")):(this.submitBtn.attr("disabled",!0),this.openPopupBtn.attr("disabled",!0))},n.prototype.submitForm=function(){this.form.submit()},o.prototype.closePopup=function(){this.popup.removeClass("open")},o.prototype.openPopup=function(){this.popup.addClass("open")},$("body").animate({opacity:1},500);var b=new i($(".slider-nav")),g=(new n($(".form")),new o($(".logout")),new t($(".dropdown-menu .menu")));$(".write-commit").each(function(){new e(this)}),m=new Swiper(".swiper-container-navigation",{direction:"vertical",spaceBetween:15,slidesPerView:"auto",scrollbar:{el:".swiper-scrollbar"},mousewheel:!0}),f=function(){var e=new Swiper(".swiper-container-nested",{direction:"horizontal",mousewheel:!0,spaceBetween:30,freeMode:!0,slidesPerView:"auto",breakpoints:{1480:{slidesPerView:"auto"},800:{slidesPerView:"auto"},640:{slidesPerView:"auto",pagination:{el:".swiper-pagination",type:"progressbar"}}},nested:!0,navigation:{nextEl:".nested-button-next",prevEl:".nested-button-prev"}});return $(e).each(function(e){$(this.$el).data("el",e),this.on("progress",p)}),e}(),m.on("click",function(e){var t=$(e.target).closest(".swiper-slide");if(t.length){var i=t.data("slide"),n=$(".swiper-container-parent .swiper-slide[data-hash="+i+"]").index();$(".swiper-container-navigation .swiper-slide").removeClass("active-nav"),t.addClass("active-nav"),m.slideTo(n,0,!1),h.slideTo(n,500,!1)}}),$(".scrollbar-wrapper").overlayScrollbars({}),$(".textarea").overlayScrollbars({textarea:{dynWidth:!1,dynHeight:!1}}),[].slice.call(document.querySelectorAll("button.progress-button")).forEach(function(e){new ProgressButton(e,{callback:function(e){var t=0,i=setInterval(function(){t=Math.min(t+.1*Math.random(),1),e._setProgress(t),1===t&&(e._stop(1),clearInterval(i))},200)}})}),$(window).on("resize",u),$(".button-return").on("click",function(){var e=$(".button-return").data("return"),t=$(".swiper-container-parent .swiper-slide[data-hash="+e+"]").index();h.slideTo(t,500,!1)}),$(".mobile-button-return").on("click",function(){var e=$(this).data("return"),t=$(".swiper-container-parent .swiper-slide[data-hash="+e+"]");$("html, body").animate({scrollTop:t.offset().top-70},500)}),$('a[href^="#"]').on("click",function(e){if($(window).width()>=1024){e.preventDefault();var t=this.hash.split("#").pop();if(!t)return;var i=$(".swiper-container-parent .swiper-slide[data-hash="+t+"]").index();$(".swiper-container-navigation .swiper-slide").removeClass("active-nav"),m.slideTo(i,0,!1),h.slideTo(i,500,!1);var n=$(".menu .sub-menu li[data-hash="+t+"]");g.toggleActiveLink(n)}else{e.preventDefault();var t=this.hash.split("#").pop();if(!t)return;var i=$(".swiper-container-parent .swiper-slide[data-hash="+t+"]");$("html, body").animate({scrollTop:i.offset().top-70},500)}}),u()});